<html>
<head>
<title>Jasmine Animation test</title>
<script src="../js/jasmine.js"></script>
<script src="../js/jasmine_anim.js"></script>
<style>
.blob
{
  background-color: red;
  position: absolute;
  overflow: hidden;
}
</style>

</head>
<body>
<h1>Jasmine Animation test</h1>
<p>LinearSignal: <span id="linear">?</span>
<div class="blob" id="blob.linear"></div>
<p>SawtoothSignal: <span id="sawtooth">?</span>
<div class="blob" id="blob.sawtooth"></div>
<p>TriangleSignal: <span id="triangle">?</span>
<div class="blob" id="blob.triangle"></div>
<p>SineSignal: <span id="sine">?</span>
<div class="blob" id="blob.sine"></div>
<p>RandomSignal: <span id="random">?</span>
<div class="blob" id="blob.random"></div>
<p>SignalSplitter(1): <span id="split1">?</span>
<div class="blob" id="blob.split1"></div>
<p>SignalSplitter(2): <span id="split2">?</span>
<div class="blob" id="blob.split2"></div>
<p>Interpolated point is <span id="point">?</span>
<div class="blob" id="bigblob"></div>

<script>
with (Jasmine)
{
  // Create a target which sets value in given DOM id
  function Target(id, y)
  {
    with (Jasmine)
    {
      this.element = document.getElementById(id);
      this.thing = new DOMThing("blob."+id, new Vector(0, y), new Vector(5,5));
      this.last_v = 0;
    }
  }

  Target.prototype.set_scalar = function(v)
  {
    with (Jasmine)
    {
      this.element.innerHTML = v.toString();
      this.thing.move_by(new Vector((v-this.last_v)*1000, 0, 0));
      this.last_v = v;
    }
  }

  // Target to log a vector in given Dom ID
  function VectorTarget(id)
  {
    this.element = document.getElementById(id);
  }

  VectorTarget.prototype.set_vector = function(vector)
  {
    this.element.innerHTML = vector.toString();
  }

  // Linear signal
  Universe.add_ticker(new LinearSignal(new Target("linear", 50), 5000));

  // Sawtooth signal
  Universe.add_ticker(new SawtoothSignal(new Target("sawtooth", 100), 5000));

  // Triangle signal
  Universe.add_ticker(new TriangleSignal(new Target("triangle", 150), 5000));

  // Sine signal
  Universe.add_ticker(new SineSignal(new Target("sine", 200), 5000));

  // Random signal
  Universe.add_ticker(new RandomSignal(new Target("random", 250), 1000));

  // Split signal
  var s1 = new Target("split1", 300);
  var s2 = new Target("split2", 320);

  var sp = new SignalSplitter([ s1 ]);
  sp.add( s2 );
  Universe.add_ticker(new SineSignal(sp, 5000));
  setTimeout("sp.remove(s2);", 10000);

  // Create interpolator from Sawtooth
  var i = new VectorInterpolator(new VectorTarget("point"),
                                 new Vector(0,0,0), new Vector(100,200,300));
  Universe.add_ticker(new SawtoothSignal(i, 5000));

  // Same, but with position and size binders on a real object
  // Sine waves are 90o out of phase, producing an oval, until y
  // gives up after 5 cycles
  var d = new DOMThing("bigblob", new Vector(100,100), new Vector(10,10));

  // X axis
  var pbx = new PositionBinder(d);
  var i2x = new VectorInterpolator(pbx, new Vector(800, 0));
  Universe.add_ticker(new SineSignal(i2x, 5000));

  // Y axis
  var pby = new PositionBinder(d);
  var i2y = new VectorInterpolator(pby, new Vector(0, 400));
  Universe.add_ticker(new SineSignal(i2y, 5000, Math.PI/2, 5));

  // Size
  var sb = new SizeBinder(d);
  var i3 = new VectorInterpolator(sb, new Vector(20, 20));
  Universe.add_ticker(new TriangleSignal(i3, 1000));

  // Colour
  var bcb = new BackgroundColorBinder(d);
  var i4 = new VectorInterpolator(bcb, new Vector(0,1,1), new Vector(1,0,0));
  Universe.add_ticker(new TriangleSignal(i4, 1000));

  // Alpha
  var ab = new AlphaBinder(d);
  var i5 = new ScalarInterpolator(ab, 0, 1);
  Universe.add_ticker(new SineSignal(i5, 5000));

  // Visibility
  var vb = new VisibilityBinder(d, 0.25);
  var i6 = new ScalarInterpolator(vb, 0, 1);
  Universe.add_ticker(new SawtoothSignal(i6, 500));

  Universe.start();
}
</script>

</html>
