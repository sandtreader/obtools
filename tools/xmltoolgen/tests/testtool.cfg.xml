<?xml version="1.0"?>
<!--
  Copyright (c) 2004 xMill Consulting Limited
-->

<xt:tool xmlns:xt="obtools.com/ns/tools">

  <!-- Setup of script processing for rest of file -->
  <xt:script language="C++">
    <!-- Tags to support C++ in XML - $ isn't significant to either -->
    <xt:tags>
      <xt:start-code>$(</xt:start-code>
      <xt:end-code>)$</xt:end-code>
      <xt:start-expr>$=</xt:start-expr>
      <xt:end-expr>=$</xt:end-expr>
    </xt:tags>
  </xt:script>

  <xt:template name="Book" element="book">
    <xt:dir>$= book["name"] =$</xt:dir>
    <xt:file>index.html</xt:file>

    <!-- Book  title -->
    <xt:template name = "Book title" element="title">
      <H1>$= *title =$</H1>
    </xt:template>

    <!-- Chapter links -->
    <UL>
    <xt:template name = "Chapter links" element="chapter" var="ch">
      <LI><A HREF='$= ch["id"] =$/index.html'>Chapter $= _index+1 =$</A></LI>
    </xt:template>
    </UL>

    <xt:template name="Chapter" element="chapter" var="ch">
      <xt:dir>$= ch["id"] =$</xt:dir>
      <xt:file>index.html</xt:file>

      <!-- Chapter title -->
      <xt:template name = "Chapter title" element="title">
	<H1>$= *title =$</H1>
      </xt:template>

      <!-- Chapter paragraphs -->
      <xt:template name = "Chapter introductory paras" element="para">
	<P>$= *para =$</P>
      </xt:template>

      <!-- Section links -->
      <UL>
      <xt:template name = "Section links" element="section">
	<LI><A HREF='sec.$= section["id"] =$.html'>Section $= _index+1 =$</A>
        </LI>
      </xt:template>
      </UL>

      <!-- Sections -->
      <xt:template name = "Sections" element="section">
	<xt:file>sec.$= section["id"] =$.html</xt:file>

	<!-- Section title -->
	<xt:template name = "Section title" element="title">
	  <H1>$= *title =$</H1>
	</xt:template>

	<!-- Section paragraphs -->
	<xt:template name = "Section paras" element="para">
	  <P>$= *para =$</P>
	</xt:template>
      </xt:template>
    </xt:template>
  </xt:template>
</xt:tool>  







